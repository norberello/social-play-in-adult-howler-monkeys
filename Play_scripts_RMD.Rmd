---
title: "Adult social play study scripts"
author: "Norberto Asensio"
date: "28/12/20"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Scripts for the study "Socioecological correlates of social play in adult howler monkeys (*Alouatta palliata mexicana* and *A. p. palliata*)"

## Play by age class and group

```{r}
rm(list=ls())#clean memory
setwd("~/Documents/R scripts and data/PLAY")#set directory
data.ptime<-read.csv2("playage.csv",header=T)#enter data
head(data.ptime)#check headings
str(data.ptime)
```

```{r}
#social playtime by group
par(mar=c(5,5,2,2),cex.lab=1.5)
bymedian2 <- with(data.ptime, reorder(GROUP, -X.PLAYTOTAL, median))
#ordered by median playtime
boxplot(X.PLAYTOTAL ~ bymedian2, data = data.ptime,
        xlab = "Group ID", ylab = "%social playtime",
        varwidth = TRUE,
        col = "lightgray",outline=F,medcol="red")
means <- tapply(data.ptime$X.PLAYTOTAL,data.ptime$GROUP,mean)
points(c(1.77,1.073,0.78,0.49,0.6,0.52,1.06),pch=3,
       cex=1.5)
```

```{r}
kruskal.test(X.PLAYTOTAL ~ GROUP,data=data.ptime)
#not significant
```

## Play by months (only 37 individuals with known age)

```{r}
#only individuals with known age
data.playage<-read.csv("monthsPLAYsecond.csv",header=T)
head(data.playage)
table(data.playage$GROUP)#33 individuals from AGA the other 4 from PLA
table(data.playage$GROUP,data.playage$CLASS)
```

```{r}
#use cbind for seconds playing vs second not playing for a binomial regression on social play
play.cb<-cbind(data.playage$TOTAL_PLAY,data.playage$OBSTIMESECS)
#build the model
model.con4b<-glm(play.cb~poly(MONTHS,2),
                 data=data.playage,
                 family = binomial(link = "logit"))
#poly(MONTHS,3)
#MONTHS+I(MONTHS^2)
```

```{r}
summary(model.con4b)
confint(model.con4b, level=0.95)
par(mfrow=c(2,2))
plot(model.con4b)
par(mfrow=c(1,1))#all looks fine
```

```{r}
#plot the age model
newdata.months<- data.frame(MONTHS= seq(3,120,1))
predicted.months<- predict(model.con4b,newdata=newdata.months,                           type="response",se=T)#regression line
predicted.months.int<- predict(model.con4b,
                           newdata=newdata.months,
                           type="response",ic=T)#CIs
```

Plot it with intervals

```{r}
plot(data.playage$MONTHS,data.playage$PLAY.P,
     pch = 16,
     col="blue",xlab ="age (months)",cex=0.76, 
     ylab = "% social play",cex.lab=1.5)
lines(newdata.months$MONTHS,predicted.months$fit*100,
      lwd=2,col=2)#x100 to get %
lines(newdata.months$MONTHS, predicted.months$fit*100+
        predicted.months.int*100,lty=3)
lines(newdata.months$MONTHS, predicted.months$fit*100-
        predicted.months.int*100,lty=3)
```


```{r}
#par(mar = c(bottom, left, top, right)) 
#two plots together
par(mar=c(5,4.5,2,1),cex.lab=2)
par(mfrow=c(1,2))
boxplot(data.ptime$X.PLAYTOTAL ~ data.ptime$CLASS ,
                   ylab="% social play" ,
                   xlab="age class",outline=FALSE,main=
                     "a",cex.lab=1.5,medcol="red",
        varwidth = TRUE,
        col = "lightgray")
points(c(1.4,2.16,0.84,0.61),pch=3,cex=1.5)
plot(data.playage$MONTHS,data.playage$PLAY.P,
     pch = 16,
     col="blue",xlab = "age (months)",cex=0.76, 
     ylab = "% social play",main="b",cex.lab=1.5)
lines(newdata.months$MONTHS, predicted.months$fit*100,lwd=2,col=2)
lines(newdata.months$MONTHS, predicted.months$fit*100+
        predicted.months.int*100,lty=3)
lines(newdata.months$MONTHS, predicted.months$fit*100-
        predicted.months.int*100,lty=3)
```

```{r}
kruskal.test(X.PLAYTOTAL ~ CLASS,data=data.ptime)
```

## Adult play by group ID, subspecies and type

```{r}
setwd("~/Documents/R scripts and data/PLAY")
data.ptime<-read.csv("playdatabytype.csv",header=T)
head(data.ptime)
dim(data.ptime)
table(data.ptime$SEX)
```

```{r}
#arrange plots
par(mar=c(5,5,2,2),cex.lab=1.5)
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE))

###adult social play by SITE
bymedian2 <- with(data.ptime, reorder(SITE, -X.PLAY, median))
boxplot(X.PLAY ~ bymedian2, data = data.ptime,
        xlab = "group ID", ylab = "%social play",
        varwidth = TRUE,
        col = "lightgray",outline=F,medcol="red",main="a")
means <- tapply(data.ptime$X.PLAY,data.ptime$SITE,mean)
points(c(0.939,0.65,0.547,0.429,0.269,0.197,0.352),pch=3,
       cex=1.5)

#####adult social play subspecies
boxplot(X.PLAY ~ Subsp, data = data.ptime,
        xlab = "subspecies", ylab = "%social play",
        varwidth = TRUE,
        col = "lightgray",outline=F,medcol="red",main="b")
means <- tapply(data.ptime$X.PLAY,data.ptime$Subsp,mean)
points(c(0.83,0.37),pch=3,
       cex=1.5)

####adult social play by type
data.types<-read.csv("play types onlyb.csv",
                     header=T)
boxplot(play.per ~ type, data = data.types,
        xlab = "play types", ylab = "%social play",
        varwidth = TRUE,
        col = "lightgray",outline=F,medcol="red",main="c")
means <- tapply(data.types$play.per,data.types$X,mean)
points(c(0.34,0.175,0.108),pch=3,
       cex=1.5)
```

```{r}
####adult social play by type repeated measures Friedman ANOVA test
friedman.test(play.per~type |id,data=data.types)
kruskal.test(X.PLAY~Subsp,data=data.ptime)#adult play by subspecies
kruskal.test(ad_ad_play~SITE,data=data.ptime)#adult adult play by site
kruskal.test(ad_im_play~SITE,data=data.ptime)#adult immature play by site
kruskal.test(ad_ad_play~Subsp,data=data.ptime)#adult adult play by subsp
kruskal.test(ad_im_play~Subsp,data=data.ptime)
```

## Adult-adult social play modelling

```{r}
#create number of adults variable
adults<-data.ptime$GR-data.ptime$IMM
data.ptime$adults<-adults
head(data.ptime)
```

```{r}
#put together ad-ad play seconds and non play seconds (rest of obs time)
cb.pt<-cbind(data.ptime$ad_ad_play,data.ptime$non_ad_ad_play)
hist(cb.pt)
```

```{r}
#standarize predictors
#substract mean and divide by SD
#density
mean.dens<-mean(data.ptime$DENS)
sd.dens<-sd(data.ptime$DENS)
z.dens<-(data.ptime$DENS-mean.dens)/sd.dens

#group size (adults)
mean.gr<-mean(data.ptime$adults)
sd.gr<-sd(data.ptime$adults)
z.gr<-(data.ptime$GR-mean.gr)/sd.gr

#feeding on fruit
mean.fe<-mean(data.ptime$X.FE)
sd.fe<-sd(data.ptime$X.FE)
z.fe<-(data.ptime$X.FE-mean.fe)/sd.fe

#travel
mean.tr<-mean(data.ptime$X.TR)
sd.tr<-sd(data.ptime$X.TR)
z.tr<-(data.ptime$X.TR-mean.tr)/sd.tr

#immature ratio
mean.ir<-mean(data.ptime$IM.RATIO)
sd.ir<-sd(data.ptime$IM.RATIO)
z.ir<-(data.ptime$IM.RATIO-mean.ir)/sd.ir

#area log and standarized
log.a<-log10(data.ptime$AREA)
mean.area<-mean(log.a)
sd.area<-sd(log.a)
z.area<-(log.a-mean.area)/sd.area
```

```{r}
library(lme4)
#all possible models
null.ad.ad<-glmer(cb.pt~+(1|SITE),family=binomial,data=data.ptime)
full.ad.ad<-glmer(cb.pt~z.ir+z.gr+z.fe+z.tr+z.dens+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad1<-glmer(cb.pt~z.ir+z.gr+z.fe+z.tr+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad2<-glmer(cb.pt~z.ir+z.gr+z.fe+z.tr+z.dens+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad3<-glmer(cb.pt~z.ir+z.gr+z.fe+z.tr+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad4<-glmer(cb.pt~z.ir+z.gr+z.fe+z.dens+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad5<-glmer(cb.pt~z.ir+z.gr+z.tr+z.dens+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad6<-glmer(cb.pt~z.ir+z.fe+z.tr+z.dens+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad7<-glmer(cb.pt~z.gr+z.fe+z.tr+z.dens+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad8<-glmer(cb.pt~z.ir+z.gr+z.fe+z.tr+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad9<-glmer(cb.pt~z.ir+z.gr+z.fe+z.tr+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad10<-glmer(cb.pt~z.ir+z.gr+z.fe+z.tr+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad11<-glmer(cb.pt~z.ir+z.gr+z.fe+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad12<-glmer(cb.pt~z.ir+z.gr+z.fe+z.dens+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad13<-glmer(cb.pt~z.ir+z.gr+z.fe+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad14<-glmer(cb.pt~z.ir+z.gr+z.tr+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad15<-glmer(cb.pt~z.ir+z.gr+z.tr+z.dens+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad16<-glmer(cb.pt~z.ir+z.gr+z.tr+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad17<-glmer(cb.pt~z.ir+z.gr+z.dens+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad18<-glmer(cb.pt~z.ir+z.fe+z.tr+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad19<-glmer(cb.pt~z.ir+z.fe+z.tr+z.dens+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad20<-glmer(cb.pt~z.ir+z.fe+z.tr+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad21<-glmer(cb.pt~z.ir+z.fe+z.dens+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad22<-glmer(cb.pt~z.ir+z.tr+z.dens+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad23<-glmer(cb.pt~z.gr+z.fe+z.tr+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad24<-glmer(cb.pt~z.gr+z.fe+z.tr+z.dens+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad25<-glmer(cb.pt~z.gr+z.fe+z.tr+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad26<-glmer(cb.pt~z.gr+z.fe+z.dens+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad27<-glmer(cb.pt~z.gr+z.tr+z.dens+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad28<-glmer(cb.pt~z.fe+z.tr+z.dens+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad29<-glmer(cb.pt~z.ir+z.gr+z.fe+z.tr+(1|SITE),family=binomial,data=data.ptime)
mo.adad30<-glmer(cb.pt~z.ir+z.gr+z.fe+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad31<-glmer(cb.pt~z.ir+z.gr+z.fe+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad32<-glmer(cb.pt~z.ir+z.gr+z.fe+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad33<-glmer(cb.pt~z.ir+z.gr+z.tr+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad34<-glmer(cb.pt~z.ir+z.gr+z.tr+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad35<-glmer(cb.pt~z.ir+z.gr+z.tr+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad36<-glmer(cb.pt~z.ir+z.gr+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad37<-glmer(cb.pt~z.ir+z.gr+z.dens+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad38<-glmer(cb.pt~z.ir+z.gr+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad39<-glmer(cb.pt~z.ir+z.fe+z.tr+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad40<-glmer(cb.pt~z.ir+z.fe+z.tr+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad41<-glmer(cb.pt~z.ir+z.fe+z.tr+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad42<-glmer(cb.pt~z.ir+z.fe+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad43<-glmer(cb.pt~z.ir+z.fe+z.dens+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad44<-glmer(cb.pt~z.ir+z.fe+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad45<-glmer(cb.pt~z.ir+z.tr+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad46<-glmer(cb.pt~z.ir+z.tr+z.dens+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad47<-glmer(cb.pt~z.ir+z.tr+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad48<-glmer(cb.pt~z.ir+z.dens+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad49<-glmer(cb.pt~z.gr+z.fe+z.tr+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad50<-glmer(cb.pt~z.gr+z.fe+z.tr+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad51<-glmer(cb.pt~z.gr+z.fe+z.tr+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad52<-glmer(cb.pt~z.gr+z.fe+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad53<-glmer(cb.pt~z.gr+z.fe+z.dens+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad54<-glmer(cb.pt~z.gr+z.fe+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad55<-glmer(cb.pt~z.gr+z.tr+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad56<-glmer(cb.pt~z.gr+z.tr+z.dens+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad57<-glmer(cb.pt~z.gr+z.tr+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad58<-glmer(cb.pt~z.gr+z.dens+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad59<-glmer(cb.pt~z.fe+z.tr+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad60<-glmer(cb.pt~z.fe+z.tr+z.dens+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad61<-glmer(cb.pt~z.fe+z.tr+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad62<-glmer(cb.pt~z.fe+z.dens+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad63<-glmer(cb.pt~z.tr+z.dens+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad64<-glmer(cb.pt~z.ir+z.gr+z.fe+(1|SITE),family=binomial,data=data.ptime)
mo.adad65<-glmer(cb.pt~z.ir+z.gr+z.tr+(1|SITE),family=binomial,data=data.ptime)
mo.adad66<-glmer(cb.pt~z.ir+z.gr+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad67<-glmer(cb.pt~z.ir+z.gr+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad68<-glmer(cb.pt~z.ir+z.gr+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad69<-glmer(cb.pt~z.ir+z.fe+z.tr+(1|SITE),family=binomial,data=data.ptime)
mo.adad70<-glmer(cb.pt~z.ir+z.fe+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad71<-glmer(cb.pt~z.ir+z.fe+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad72<-glmer(cb.pt~z.ir+z.fe+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad73<-glmer(cb.pt~z.ir+z.tr+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad74<-glmer(cb.pt~z.ir+z.tr+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad75<-glmer(cb.pt~z.ir+z.tr+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad76<-glmer(cb.pt~z.ir+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad77<-glmer(cb.pt~z.ir+z.dens+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad78<-glmer(cb.pt~z.ir+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad79<-glmer(cb.pt~z.gr+z.fe+z.tr+(1|SITE),family=binomial,data=data.ptime)
mo.adad80<-glmer(cb.pt~z.gr+z.fe+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad81<-glmer(cb.pt~z.gr+z.fe+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad82<-glmer(cb.pt~z.gr+z.fe+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad83<-glmer(cb.pt~z.gr+z.tr+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad84<-glmer(cb.pt~z.gr+z.tr+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad85<-glmer(cb.pt~z.gr+z.tr+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad86<-glmer(cb.pt~z.gr+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad87<-glmer(cb.pt~z.gr+z.dens+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad88<-glmer(cb.pt~z.gr+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad89<-glmer(cb.pt~z.fe+z.tr+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad90<-glmer(cb.pt~z.fe+z.tr+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad91<-glmer(cb.pt~z.fe+z.tr+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad92<-glmer(cb.pt~z.fe+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad93<-glmer(cb.pt~z.fe+z.dens+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad94<-glmer(cb.pt~z.fe+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad95<-glmer(cb.pt~z.tr+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad96<-glmer(cb.pt~z.tr+z.dens+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad97<-glmer(cb.pt~z.tr+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad98<-glmer(cb.pt~z.dens+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad99<-glmer(cb.pt~z.ir+z.gr+(1|SITE),family=binomial,data=data.ptime)
mo.adad100<-glmer(cb.pt~z.ir+z.fe+(1|SITE),family=binomial,data=data.ptime)
mo.adad101<-glmer(cb.pt~z.ir+z.tr+(1|SITE),family=binomial,data=data.ptime)
mo.adad102<-glmer(cb.pt~z.ir+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad103<-glmer(cb.pt~z.ir+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad104<-glmer(cb.pt~z.ir+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad105<-glmer(cb.pt~z.gr+z.fe+(1|SITE),family=binomial,data=data.ptime)
mo.adad106<-glmer(cb.pt~z.gr+z.tr+(1|SITE),family=binomial,data=data.ptime)
mo.adad107<-glmer(cb.pt~z.gr+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad108<-glmer(cb.pt~z.gr+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad109<-glmer(cb.pt~z.gr+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad110<-glmer(cb.pt~z.fe+z.tr+(1|SITE),family=binomial,data=data.ptime)
mo.adad111<-glmer(cb.pt~z.fe+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad112<-glmer(cb.pt~z.fe+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad113<-glmer(cb.pt~z.fe+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad114<-glmer(cb.pt~z.tr+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad115<-glmer(cb.pt~z.tr+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad116<-glmer(cb.pt~z.tr+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad117<-glmer(cb.pt~z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad118<-glmer(cb.pt~z.dens+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad119<-glmer(cb.pt~SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad120<-glmer(cb.pt~z.ir+(1|SITE),family=binomial,data=data.ptime)
mo.adad121<-glmer(cb.pt~z.gr+(1|SITE),family=binomial,data=data.ptime)
mo.adad122<-glmer(cb.pt~z.fe+(1|SITE),family=binomial,data=data.ptime)
mo.adad123<-glmer(cb.pt~z.tr+(1|SITE),family=binomial,data=data.ptime)
mo.adad124<-glmer(cb.pt~z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad125<-glmer(cb.pt~SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad126<-glmer(cb.pt~z.area+(1|SITE),family=binomial,data=data.ptime)
```

```{r}
#check VIF
library(car)
vif(full.ad.ad)
vif(mo.adad1)
vif(mo.adad2)
vif(mo.adad3)
vif(mo.adad4)
vif(mo.adad5)
vif(mo.adad6)
vif(mo.adad7)
vif(mo.adad8)
vif(mo.adad9)
vif(mo.adad10)
vif(mo.adad11)
vif(mo.adad12)
vif(mo.adad13)
vif(mo.adad14)
vif(mo.adad15)
vif(mo.adad16)
vif(mo.adad17)
vif(mo.adad18)
vif(mo.adad19)
vif(mo.adad20)
vif(mo.adad21)
vif(mo.adad22)
vif(mo.adad23)
vif(mo.adad24)
vif(mo.adad25)
vif(mo.adad26)
vif(mo.adad27)
vif(mo.adad28)
vif(mo.adad29)
vif(mo.adad30)
vif(mo.adad31)
vif(mo.adad32)
vif(mo.adad33)
vif(mo.adad34)
vif(mo.adad35)
vif(mo.adad36)
vif(mo.adad37)
vif(mo.adad38)
vif(mo.adad39)
vif(mo.adad40)
vif(mo.adad41)
vif(mo.adad42)
vif(mo.adad43)
vif(mo.adad44)
vif(mo.adad45)
vif(mo.adad46)
vif(mo.adad47)
vif(mo.adad48)
vif(mo.adad49)
vif(mo.adad50)
vif(mo.adad51)
vif(mo.adad52)
vif(mo.adad53)
vif(mo.adad54)
vif(mo.adad55)
vif(mo.adad56)
vif(mo.adad57)
vif(mo.adad58)
vif(mo.adad59)
vif(mo.adad60)
vif(mo.adad61)
vif(mo.adad62)
vif(mo.adad63)
vif(mo.adad64)
vif(mo.adad65)
vif(mo.adad66)
vif(mo.adad67)
vif(mo.adad68)
vif(mo.adad69)
vif(mo.adad70)
vif(mo.adad71)
vif(mo.adad72)
vif(mo.adad73)
vif(mo.adad74)
vif(mo.adad75)
vif(mo.adad76)
vif(mo.adad77)
vif(mo.adad78)
vif(mo.adad79)
vif(mo.adad80)
vif(mo.adad81)
vif(mo.adad82)
vif(mo.adad83)
vif(mo.adad84)
vif(mo.adad85)
vif(mo.adad86)
vif(mo.adad87)
vif(mo.adad88)
vif(mo.adad89)
vif(mo.adad90)
vif(mo.adad91)
vif(mo.adad92)
vif(mo.adad93)
vif(mo.adad94)
vif(mo.adad95)
vif(mo.adad96)
vif(mo.adad97)
vif(mo.adad98)
vif(mo.adad99)
vif(mo.adad100)
vif(mo.adad101)
vif(mo.adad102)
vif(mo.adad103)
vif(mo.adad104)
vif(mo.adad105)
vif(mo.adad106)
vif(mo.adad107)
vif(mo.adad108)
vif(mo.adad109)
vif(mo.adad110)
vif(mo.adad111)
vif(mo.adad112)
vif(mo.adad113)
vif(mo.adad114)
vif(mo.adad115)
vif(mo.adad116)
vif(mo.adad117)
vif(mo.adad118)
vif(mo.adad119)
```

```{r}
#Only models without significant VIF
null.ad.ad<-glmer(cb.pt~+(1|SITE),family=binomial,data=data.ptime)
mo.adad1<-glmer(cb.pt~z.ir+z.gr+z.fe+z.tr+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad3<-glmer(cb.pt~z.ir+z.gr+z.fe+z.tr+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad8<-glmer(cb.pt~z.ir+z.gr+z.fe+z.tr+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad9<-glmer(cb.pt~z.ir+z.gr+z.fe+z.tr+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad10<-glmer(cb.pt~z.ir+z.gr+z.fe+z.tr+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad11<-glmer(cb.pt~z.ir+z.gr+z.fe+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad13<-glmer(cb.pt~z.ir+z.gr+z.fe+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad14<-glmer(cb.pt~z.ir+z.gr+z.tr+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad16<-glmer(cb.pt~z.ir+z.gr+z.tr+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad18<-glmer(cb.pt~z.ir+z.fe+z.tr+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad20<-glmer(cb.pt~z.ir+z.fe+z.tr+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad23<-glmer(cb.pt~z.gr+z.fe+z.tr+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad25<-glmer(cb.pt~z.gr+z.fe+z.tr+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad29<-glmer(cb.pt~z.ir+z.gr+z.fe+z.tr+(1|SITE),family=binomial,data=data.ptime)
mo.adad30<-glmer(cb.pt~z.ir+z.gr+z.fe+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad31<-glmer(cb.pt~z.ir+z.gr+z.fe+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad32<-glmer(cb.pt~z.ir+z.gr+z.fe+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad33<-glmer(cb.pt~z.ir+z.gr+z.tr+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad34<-glmer(cb.pt~z.ir+z.gr+z.tr+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad35<-glmer(cb.pt~z.ir+z.gr+z.tr+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad36<-glmer(cb.pt~z.ir+z.gr+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad38<-glmer(cb.pt~z.ir+z.gr+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad39<-glmer(cb.pt~z.ir+z.fe+z.tr+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad40<-glmer(cb.pt~z.ir+z.fe+z.tr+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad41<-glmer(cb.pt~z.ir+z.fe+z.tr+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad42<-glmer(cb.pt~z.ir+z.fe+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad44<-glmer(cb.pt~z.ir+z.fe+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad45<-glmer(cb.pt~z.ir+z.tr+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad47<-glmer(cb.pt~z.ir+z.tr+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad49<-glmer(cb.pt~z.gr+z.fe+z.tr+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad50<-glmer(cb.pt~z.gr+z.fe+z.tr+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad51<-glmer(cb.pt~z.gr+z.fe+z.tr+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad52<-glmer(cb.pt~z.gr+z.fe+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad54<-glmer(cb.pt~z.gr+z.fe+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad55<-glmer(cb.pt~z.gr+z.tr+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad57<-glmer(cb.pt~z.gr+z.tr+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad59<-glmer(cb.pt~z.fe+z.tr+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad61<-glmer(cb.pt~z.fe+z.tr+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad64<-glmer(cb.pt~z.ir+z.gr+z.fe+(1|SITE),family=binomial,data=data.ptime)
mo.adad65<-glmer(cb.pt~z.ir+z.gr+z.tr+(1|SITE),family=binomial,data=data.ptime)
mo.adad66<-glmer(cb.pt~z.ir+z.gr+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad67<-glmer(cb.pt~z.ir+z.gr+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad68<-glmer(cb.pt~z.ir+z.gr+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad69<-glmer(cb.pt~z.ir+z.fe+z.tr+(1|SITE),family=binomial,data=data.ptime)
mo.adad70<-glmer(cb.pt~z.ir+z.fe+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad71<-glmer(cb.pt~z.ir+z.fe+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad72<-glmer(cb.pt~z.ir+z.fe+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad73<-glmer(cb.pt~z.ir+z.tr+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad74<-glmer(cb.pt~z.ir+z.tr+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad75<-glmer(cb.pt~z.ir+z.tr+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad76<-glmer(cb.pt~z.ir+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad78<-glmer(cb.pt~z.ir+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad79<-glmer(cb.pt~z.gr+z.fe+z.tr+(1|SITE),family=binomial,data=data.ptime)
mo.adad80<-glmer(cb.pt~z.gr+z.fe+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad81<-glmer(cb.pt~z.gr+z.fe+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad82<-glmer(cb.pt~z.gr+z.fe+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad83<-glmer(cb.pt~z.gr+z.tr+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad84<-glmer(cb.pt~z.gr+z.tr+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad85<-glmer(cb.pt~z.gr+z.tr+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad86<-glmer(cb.pt~z.gr+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad88<-glmer(cb.pt~z.gr+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad89<-glmer(cb.pt~z.fe+z.tr+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad90<-glmer(cb.pt~z.fe+z.tr+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad91<-glmer(cb.pt~z.fe+z.tr+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad92<-glmer(cb.pt~z.fe+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad93<-glmer(cb.pt~z.fe+z.dens+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad94<-glmer(cb.pt~z.fe+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad95<-glmer(cb.pt~z.tr+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad97<-glmer(cb.pt~z.tr+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad99<-glmer(cb.pt~z.ir+z.gr+(1|SITE),family=binomial,data=data.ptime)
mo.adad100<-glmer(cb.pt~z.ir+z.fe+(1|SITE),family=binomial,data=data.ptime)
mo.adad101<-glmer(cb.pt~z.ir+z.tr+(1|SITE),family=binomial,data=data.ptime)
mo.adad102<-glmer(cb.pt~z.ir+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad103<-glmer(cb.pt~z.ir+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad104<-glmer(cb.pt~z.ir+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad105<-glmer(cb.pt~z.gr+z.fe+(1|SITE),family=binomial,data=data.ptime)
mo.adad106<-glmer(cb.pt~z.gr+z.tr+(1|SITE),family=binomial,data=data.ptime)
mo.adad107<-glmer(cb.pt~z.gr+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad108<-glmer(cb.pt~z.gr+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad109<-glmer(cb.pt~z.gr+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad110<-glmer(cb.pt~z.fe+z.tr+(1|SITE),family=binomial,data=data.ptime)
mo.adad111<-glmer(cb.pt~z.fe+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad112<-glmer(cb.pt~z.fe+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad113<-glmer(cb.pt~z.fe+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad114<-glmer(cb.pt~z.tr+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad115<-glmer(cb.pt~z.tr+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad116<-glmer(cb.pt~z.tr+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad117<-glmer(cb.pt~z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad119<-glmer(cb.pt~SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad120<-glmer(cb.pt~z.ir+(1|SITE),family=binomial,data=data.ptime)
mo.adad121<-glmer(cb.pt~z.gr+(1|SITE),family=binomial,data=data.ptime)
mo.adad122<-glmer(cb.pt~z.fe+(1|SITE),family=binomial,data=data.ptime)
mo.adad123<-glmer(cb.pt~z.tr+(1|SITE),family=binomial,data=data.ptime)
mo.adad124<-glmer(cb.pt~z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad125<-glmer(cb.pt~SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad126<-glmer(cb.pt~z.area+(1|SITE),family=binomial,data=data.ptime)
```

```{r}
#table of models
library(MuMIn)
Cand.mod.all<-list(null.ad.ad,
                   mo.adad1,
                   mo.adad3,
                   mo.adad8,
                   mo.adad9,
                   mo.adad10,
                   mo.adad11,
                   mo.adad13,
                   mo.adad14,
                   mo.adad16,
                   mo.adad18,
                   mo.adad20,
                   mo.adad23,
                   mo.adad25,
                   mo.adad29,
                   mo.adad30,
                   mo.adad31,
                   mo.adad32,
                   mo.adad33,
                   mo.adad34,
                   mo.adad35,
                   mo.adad36,
                   mo.adad38,
                   mo.adad39,
                   mo.adad40,
                   mo.adad41,
                   mo.adad42,
                   mo.adad44,
                   mo.adad45,
                   mo.adad47,
                   mo.adad49,
                   mo.adad50,
                   mo.adad51,
                   mo.adad52,
                   mo.adad54,
                   mo.adad55,
                   mo.adad57,
                   mo.adad59,
                   mo.adad61,
                   mo.adad64,
                   mo.adad65,
                   mo.adad66,
                   mo.adad67,
                   mo.adad68,
                   mo.adad69,
                   mo.adad70,
                   mo.adad71,
                   mo.adad72,
                   mo.adad73,
                   mo.adad74,
                   mo.adad75,
                   mo.adad76,
                   mo.adad78,
                   mo.adad79,
                   mo.adad80,
                   mo.adad81,
                   mo.adad82,
                   mo.adad83,
                   mo.adad84,
                   mo.adad85,
                   mo.adad86,
                   mo.adad88,
                   mo.adad89,
                   mo.adad90,
                   mo.adad91,
                   mo.adad92,
                   mo.adad93,
                   mo.adad94,
                   mo.adad95,
                   mo.adad97,
                   mo.adad99,
                   mo.adad100,
                   mo.adad101,
                   mo.adad102,
                   mo.adad103,
                   mo.adad104,
                   mo.adad105,
                   mo.adad106,
                   mo.adad107,
                   mo.adad108,
                   mo.adad109,
                   mo.adad110,
                   mo.adad111,
                   mo.adad112,
                   mo.adad113,
                   mo.adad114,
                   mo.adad115,
                   mo.adad116,
                   mo.adad117,
                   mo.adad119,
                   mo.adad120,
                   mo.adad121,
                   mo.adad122,
                   mo.adad123,
                   mo.adad124,
                   mo.adad125,
                   mo.adad126)
Modnames1<-c("null.ad.ad=",
             "mo.adad1=z.ir+z.gr+z.fe+z.tr+z.dens+SEX",
             "mo.adad3=z.ir+z.gr+z.fe+z.tr+SEX+z.area",
             "mo.adad8=z.ir+z.gr+z.fe+z.tr+z.dens",
             "mo.adad9=z.ir+z.gr+z.fe+z.tr+SEX",
             "mo.adad10=z.ir+z.gr+z.fe+z.tr+z.area",
             "mo.adad11=z.ir+z.gr+z.fe+z.dens+SEX",
             "mo.adad13=z.ir+z.gr+z.fe+SEX+z.area",
             "mo.adad14=z.ir+z.gr+z.tr+z.dens+SEX",
             "mo.adad16=z.ir+z.gr+z.tr+SEX+z.area",
             "mo.adad18=z.ir+z.fe+z.tr+z.dens+SEX",
             "mo.adad20=z.ir+z.fe+z.tr+SEX+z.area",
             "mo.adad23=z.gr+z.fe+z.tr+z.dens+SEX",
             "mo.adad25=z.gr+z.fe+z.tr+SEX+z.area",
             "mo.adad29=z.ir+z.gr+z.fe+z.tr",
             "mo.adad30=z.ir+z.gr+z.fe+z.dens",
             "mo.adad31=z.ir+z.gr+z.fe+SEX",
             "mo.adad32=z.ir+z.gr+z.fe+z.area",
             "mo.adad33=z.ir+z.gr+z.tr+z.dens",
             "mo.adad34=z.ir+z.gr+z.tr+SEX",
             "mo.adad35=z.ir+z.gr+z.tr+z.area",
             "mo.adad36=z.ir+z.gr+z.dens+SEX",
             "mo.adad38=z.ir+z.gr+SEX+z.area",
             "mo.adad39=z.ir+z.fe+z.tr+z.dens",
             "mo.adad40=z.ir+z.fe+z.tr+SEX",
             "mo.adad41=z.ir+z.fe+z.tr+z.area",
             "mo.adad42=z.ir+z.fe+z.dens+SEX",
             "mo.adad44=z.ir+z.fe+SEX+z.area",
             "mo.adad45=z.ir+z.tr+z.dens+SEX",
             "mo.adad47=z.ir+z.tr+SEX+z.area",
             "mo.adad49=z.gr+z.fe+z.tr+z.dens",
             "mo.adad50=z.gr+z.fe+z.tr+SEX",
             "mo.adad51=z.gr+z.fe+z.tr+z.area",
             "mo.adad52=z.gr+z.fe+z.dens+SEX",
             "mo.adad54=z.gr+z.fe+SEX+z.area",
             "mo.adad55=z.gr+z.tr+z.dens+SEX",
             "mo.adad57=z.gr+z.tr+SEX+z.area",
             "mo.adad59=z.fe+z.tr+z.dens+SEX",
             "mo.adad61=z.fe+z.tr+SEX+z.area",
             "mo.adad64=z.ir+z.gr+z.fe",
             "mo.adad65=z.ir+z.gr+z.tr",
             "mo.adad66=z.ir+z.gr+z.dens",
             "mo.adad67=z.ir+z.gr+SEX",
             "mo.adad68=z.ir+z.gr+z.area",
             "mo.adad69=z.ir+z.fe+z.tr",
             "mo.adad70=z.ir+z.fe+z.dens",
             "mo.adad71=z.ir+z.fe+SEX",
             "mo.adad72=z.ir+z.fe+z.area",
             "mo.adad73=z.ir+z.tr+z.dens",
             "mo.adad74=z.ir+z.tr+SEX",
             "mo.adad75=z.ir+z.tr+z.area",
             "mo.adad76=z.ir+z.dens+SEX",
             "mo.adad78=z.ir+SEX+z.area",
             "mo.adad79=z.gr+z.fe+z.tr",
             "mo.adad80=z.gr+z.fe+z.dens",
             "mo.adad81=z.gr+z.fe+SEX",
             "mo.adad82=z.gr+z.fe+z.area",
             "mo.adad83=z.gr+z.tr+z.dens",
             "mo.adad84=z.gr+z.tr+SEX",
             "mo.adad85=z.gr+z.tr+z.area",
             "mo.adad86=z.gr+z.dens+SEX",
             "mo.adad88=z.gr+SEX+z.area",
             "mo.adad89=z.fe+z.tr+z.dens",
             "mo.adad90=z.fe+z.tr+SEX",
             "mo.adad91=z.fe+z.tr+z.area",
             "mo.adad92=z.fe+z.dens+SEX",
             "mo.adad93=z.fe+z.dens+z.area",
             "mo.adad94=z.fe+SEX+z.area",
             "mo.adad95=z.tr+z.dens+SEX",
             "mo.adad97=z.tr+SEX+z.area",
             "mo.adad99=z.ir+z.gr",
             "mo.adad100=z.ir+z.fe",
             "mo.adad101=z.ir+z.tr",
             "mo.adad102=z.ir+z.dens",
             "mo.adad103=z.ir+SEX",
             "mo.adad104=z.ir+z.area",
             "mo.adad105=z.gr+z.fe",
             "mo.adad106=z.gr+z.tr",
             "mo.adad107=z.gr+z.dens",
             "mo.adad108=z.gr+SEX",
             "mo.adad109=z.gr+z.area",
             "mo.adad110=z.fe+z.tr",
             "mo.adad111=z.fe+z.dens",
             "mo.adad112=z.fe+SEX",
             "mo.adad113=z.fe+z.area",
             "mo.adad114=z.tr+z.dens",
             "mo.adad115=z.tr+SEX",
             "mo.adad116=z.tr+z.area",
             "mo.adad117=z.dens+SEX",
             "mo.adad119=SEX+z.area",
             "mo.adad120=z.ir",
             "mo.adad121=z.gr",
             "mo.adad122=z.fe",
             "mo.adad123=z.tr",
             "mo.adad124=z.dens",
             "mo.adad125=SEX",
             "mo.adad126=z.area")
#call AICc table 
library(AICcmodavg)
aictab(Cand.mod.all,modnames=Modnames1)
```

```{r}
#95% confset method to select models!
confset(cand.set = Cand.mod.all, modnames = Modnames1, second.ord = TRUE,
        method = "raw")  
#95% confidence set:
#  K     AICc Delta_AICc AICcWt
#mo.adad9=z.ir+z.gr+z.fe+z.tr+SEX        7 25782.82       0.00   0.62
#mo.adad3=z.ir+z.gr+z.fe+z.tr+SEX+z.area 8 25785.30       2.48   0.18
#mo.adad1=z.ir+z.gr+z.fe+z.tr+z.dens+SEX 8 25785.31       2.49   0.18
#Model probabilities sum to 0.97 
```

```{r}
plot(mo.adad9)
plot(mo.adad3)
plot(mo.adad1)
#nothing weird
```

```{r}
#average three best models
library(MuMIn)
Cand.mod.best<-list(mo.adad9,mo.adad3,mo.adad1)
mod.avg<-model.avg(Cand.mod.best)
summary(mod.avg)
```

## Plotting adult-adult models

```{r}
#for easier plotting % of social adult adult play
data.ptime$X.playim<-data.ptime$ad_ad_play/data.ptime$OBSSEC
#par(mar = c(bottom, left, top, right))
par(mfrow=c(3,2))
#GROUP SIZE FEMALES
#Create a temporary data frame of hypothetical values

newdata.gr.f.aga <- data.frame(z.gr = seq(-1.99, 2.45,0.1),z.fe=mean(z.fe),
                                  z.ir=mean(z.ir),SITE="AGA",SEX="f",z.tr=mean(z.tr),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.gr.f.liz <- data.frame(z.gr = seq(-1.99, 2.45,0.1),z.fe=mean(z.fe),
                                  z.ir=mean(z.ir),SITE="LIZ",SEX="f",z.tr=mean(z.tr),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.gr.f.pla <- data.frame(z.gr = seq(-1.99,2.45,0.1),z.fe=mean(z.fe),
                                  z.ir=mean(z.ir),SITE="PLA",SEX="f",z.tr=mean(z.tr),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.gr.f.ch <- data.frame(z.gr = seq(-1.99,2.45, 0.1),z.fe=mean(z.fe),
                               z.ir=mean(z.ir),SITE="CH",SEX="f",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.gr.f.cp <- data.frame(z.gr = seq(-1.99,2.45, 0.1),z.fe=mean(z.fe),
                               z.ir=mean(z.ir),SITE="CP",SEX="f",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.gr.f.se <- data.frame(z.gr = seq(-1.99,2.45, 0.1),z.fe=mean(z.fe),
                               z.ir=mean(z.ir),SITE="SE",SEX="f",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.gr.f.sn <- data.frame(z.gr = seq(-1.99,2.45, 0.1),z.fe=mean(z.fe),
                               z.ir=mean(z.ir),SITE="SN",SEX="f",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))

predicted.gr.f.aga <- predict(mod.avg,newdata=newdata.gr.f.aga,type="response")
predicted.gr.f.liz <- predict(mod.avg,newdata=newdata.gr.f.liz,type="response")
predicted.gr.f.pla <- predict(mod.avg,newdata=newdata.gr.f.pla,type="response")
predicted.gr.f.ch <- predict(mod.avg,newdata=newdata.gr.f.ch,type="response")
predicted.gr.f.cp <- predict(mod.avg,newdata=newdata.gr.f.cp,type="response")
predicted.gr.f.se <- predict(mod.avg,newdata=newdata.gr.f.se,type="response")
predicted.gr.f.sn <- predict(mod.avg,newdata=newdata.gr.f.sn,type="response")

#small margins
#par(mar = c(bottom, left, top, right))
par(mar = c(4, 4.5, 0.5, 0.5)) # Set the margin on all sides to 2

#group size on females
plot((z.gr*sd.gr)+mean.gr,data.ptime$X.playim*100, pch = 16,
     col="white",xlab = "number of adults",ylab="%adult-adult play", 
     ylim=c(0,5),xlim=c(0,25),cex.lab=1.5)
lines((newdata.gr.f.aga$z.gr*sd.gr)+mean.gr, predicted.gr.f.aga*100,
      lwd=2,col=1,lty=1,type="l",pch=1)
lines((newdata.gr.f.liz$z.gr*sd.gr)+mean.gr, predicted.gr.f.liz*100,
      lwd=2,col=2,lty=2,type="l",pch=2)
lines((newdata.gr.f.pla$z.gr*sd.gr)+mean.gr, predicted.gr.f.pla*100,
      lwd=2,col=3,lty=3,type="l",pch=3)
lines((newdata.gr.f.ch$z.gr*sd.gr)+mean.gr, predicted.gr.f.ch*100,
      lwd=2,col=4,lty=4,type="l",pch=4)
lines((newdata.gr.f.cp$z.gr*sd.gr)+mean.gr, predicted.gr.f.cp*100,
      lwd=2,col=5,lty=5,type="l",pch=5)
lines((newdata.gr.f.se$z.gr*sd.gr)+mean.gr, predicted.gr.f.se*100,
      lwd=2,col=6,lty=6,type="l",pch=6)
lines((newdata.gr.f.sn$z.gr*sd.gr)+mean.gr, predicted.gr.f.sn*100,
      lwd=2,col=7,lty=2,type="o",pch=18,cex=0.5)

text(20,3.85,labels='\\VE',
     vfont=c("sans serif","bold"),cex=5)
legend(0.25,5, legend=c("AGA","LIZ","PLA","CH","CP","SE","SN"),
       col=c(1,2,3,4,5,6,7), lty=c(1,2,3,4,5,6,2), cex=0.8,
       box.lty=1,lwd=1)

######GROUP SIZE ON MALES

newdata.gr.m.aga <- data.frame(z.gr = seq(-1.99, 2.45,0.1),z.fe=mean(z.fe),
                               z.ir=mean(z.ir),SITE="AGA",SEX="m",z.tr=mean(z.tr),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.gr.m.liz <- data.frame(z.gr = seq(-1.99, 2.45,0.1),z.fe=mean(z.fe),
                               z.ir=mean(z.ir),SITE="LIZ",SEX="m",z.tr=mean(z.tr),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.gr.m.pla <- data.frame(z.gr = seq(-1.99,2.45,0.1),z.fe=mean(z.fe),
                               z.ir=mean(z.ir),SITE="PLA",SEX="m",z.tr=mean(z.tr),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.gr.m.ch <- data.frame(z.gr = seq(-1.99,2.45, 0.1),z.fe=mean(z.fe),
                              z.ir=mean(z.ir),SITE="CH",SEX="m",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.gr.m.cp <- data.frame(z.gr = seq(-1.99,2.45, 0.1),z.fe=mean(z.fe),
                              z.ir=mean(z.ir),SITE="CP",SEX="m",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.gr.m.se <- data.frame(z.gr = seq(-1.99,2.45, 0.1),z.fe=mean(z.fe),
                              z.ir=mean(z.ir),SITE="SE",SEX="m",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.gr.m.sn <- data.frame(z.gr = seq(-1.99,2.45, 0.1),z.fe=mean(z.fe),
                              z.ir=mean(z.ir),SITE="SN",SEX="m",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))


predicted.gr.m.aga <- predict(mod.avg,newdata=newdata.gr.m.aga,type="response")
predicted.gr.m.liz <- predict(mod.avg,newdata=newdata.gr.m.liz,type="response")
predicted.gr.m.pla <- predict(mod.avg,newdata=newdata.gr.m.pla,type="response")
predicted.gr.m.ch <- predict(mod.avg,newdata=newdata.gr.m.ch,type="response")
predicted.gr.m.cp <- predict(mod.avg,newdata=newdata.gr.m.cp,type="response")
predicted.gr.m.se <- predict(mod.avg,newdata=newdata.gr.m.se,type="response")
predicted.gr.m.sn <- predict(mod.avg,newdata=newdata.gr.m.sn,type="response")

#group size on females
plot((z.gr*sd.gr)+mean.gr,data.ptime$X.playim*100, pch = 16,
     col="white",xlab = "number of adults",ylab="%adult-adult play", 
     ylim=c(0,5),xlim=c(0,25),cex.lab=1.5)
lines((newdata.gr.m.aga$z.gr*sd.gr)+mean.gr, predicted.gr.m.aga*100,
      lwd=2,col=1,lty=1,type="l",pch=1)
lines((newdata.gr.m.liz$z.gr*sd.gr)+mean.gr, predicted.gr.m.liz*100,
      lwd=2,col=2,lty=2,type="l",pch=2)
lines((newdata.gr.m.pla$z.gr*sd.gr)+mean.gr, predicted.gr.m.pla*100,
      lwd=2,col=3,lty=3,type="l",pch=3)
lines((newdata.gr.m.ch$z.gr*sd.gr)+mean.gr, predicted.gr.m.ch*100,
      lwd=2,col=4,lty=4,type="l",pch=4)
lines((newdata.gr.m.cp$z.gr*sd.gr)+mean.gr, predicted.gr.m.cp*100,
      lwd=2,col=5,lty=5,type="l",pch=5)
lines((newdata.gr.m.se$z.gr*sd.gr)+mean.gr, predicted.gr.m.se*100,
      lwd=2,col=6,lty=6,type="l",pch=6)
lines((newdata.gr.m.sn$z.gr*sd.gr)+mean.gr, predicted.gr.m.sn*100,
      lwd=2,col=7,lty=2,type="o",pch=18,cex=0.5)
text(20,3.85,labels='\\MA',
     vfont=c("sans serif","bold"),cex=5)

#IR immature to adult ratio
(0-mean.ir)/sd.ir
(1.5-mean.ir)/sd.ir

#FEMALES
newdata.ir.f.aga <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                               z.ir=seq(-2.08,7.4,0.1),SITE="AGA",SEX="f",z.tr=mean(z.tr),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.ir.f.liz <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                               z.ir=seq(-2.08,7.4,0.1),SITE="LIZ",SEX="f",z.tr=mean(z.tr),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.ir.f.pla <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                               z.ir=seq(-2.08,7.4,0.1),SITE="PLA",SEX="f",z.tr=mean(z.tr),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.ir.f.ch <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                              z.ir=seq(-2.08,7.4,0.1),SITE="CH",SEX="f",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.ir.f.cp <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                              z.ir=seq(-2.08,7.4,0.1),SITE="CP",SEX="f",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.ir.f.se <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                              z.ir=seq(-2.08,7.4,0.1),SITE="SE",SEX="f",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.ir.f.sn <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                              z.ir=seq(-2.08,7.4,0.1),SITE="SN",SEX="f",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))


predicted.ir.f.aga <- predict(mod.avg,newdata=newdata.ir.f.aga,type="response")
predicted.ir.f.liz <- predict(mod.avg,newdata=newdata.ir.f.liz,type="response")
predicted.ir.f.pla <- predict(mod.avg,newdata=newdata.ir.f.pla,type="response")
predicted.ir.f.ch <- predict(mod.avg,newdata=newdata.ir.f.ch,type="response")
predicted.ir.f.cp <- predict(mod.avg,newdata=newdata.ir.f.cp,type="response")
predicted.ir.f.se <- predict(mod.avg,newdata=newdata.ir.f.se,type="response")
predicted.ir.f.sn <- predict(mod.avg,newdata=newdata.ir.f.sn,type="response")


plot((z.ir*sd.ir)+mean.ir,data.ptime$X.playim*100, pch = 16,
     col="white",xlab = "immature to adult ratio",ylab="%adult-adult play", 
     ylim=c(0,5),xlim=c(0,1.5),cex.lab=1.5)
lines((newdata.ir.f.aga$z.ir*sd.ir)+mean.ir, predicted.ir.f.aga*100,
      lwd=2,col=1,lty=1,type="l",pch=1)
lines((newdata.ir.f.liz$z.ir*sd.ir)+mean.ir, predicted.ir.f.liz*100,
      lwd=2,col=2,lty=2,type="l",pch=2)
lines((newdata.ir.f.pla$z.ir*sd.ir)+mean.ir, predicted.ir.f.pla*100,
      lwd=2,col=3,lty=3,type="l",pch=3)
lines((newdata.ir.f.ch$z.ir*sd.ir)+mean.ir, predicted.ir.f.ch*100,
      lwd=2,col=4,lty=4,type="l",pch=4)
lines((newdata.ir.f.cp$z.ir*sd.ir)+mean.ir, predicted.ir.f.cp*100,
      lwd=2,col=5,lty=5,type="l",pch=5)
lines((newdata.ir.f.se$z.ir*sd.ir)+mean.ir, predicted.ir.f.se*100,
      lwd=2,col=6,lty=6,type="l",pch=6)
lines((newdata.ir.f.sn$z.ir*sd.ir)+mean.ir, predicted.ir.f.sn*100,
      lwd=2,col=7,lty=2,type="o",pch=18,cex=0.5)

text(1.25,3.85,labels='\\VE',
     vfont=c("sans serif","bold"),cex=5)

######IR ON MALES
# Create a temporary data frame of hypothetical values

newdata.ir.m.aga <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                               z.ir=seq(-2.08,7.4,0.1),SITE="AGA",SEX="m",z.tr=mean(z.tr),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.ir.m.liz <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                               z.ir=seq(-2.08,7.4,0.1),SITE="LIZ",SEX="m",z.tr=mean(z.tr),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.ir.m.pla <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                               z.ir=seq(-2.08,7.4,0.1),SITE="PLA",SEX="m",z.tr=mean(z.tr),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.ir.m.ch <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                              z.ir=seq(-2.08,7.4,0.1),SITE="CH",SEX="m",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.ir.m.cp <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                              z.ir=seq(-2.08,7.4,0.1),SITE="CP",SEX="m",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.ir.m.se <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                              z.ir=seq(-2.08,7.4,0.1),SITE="SE",SEX="m",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.ir.m.sn <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                              z.ir=seq(-2.08,7.4,0.1),SITE="SN",SEX="m",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))


predicted.ir.m.aga <- predict(mod.avg,newdata=newdata.ir.m.aga,type="response")
predicted.ir.m.liz <- predict(mod.avg,newdata=newdata.ir.m.liz,type="response")
predicted.ir.m.pla <- predict(mod.avg,newdata=newdata.ir.m.pla,type="response")
predicted.ir.m.ch <- predict(mod.avg,newdata=newdata.ir.m.ch,type="response")
predicted.ir.m.cp <- predict(mod.avg,newdata=newdata.ir.m.cp,type="response")
predicted.ir.m.se <- predict(mod.avg,newdata=newdata.ir.m.se,type="response")
predicted.ir.m.sn <- predict(mod.avg,newdata=newdata.ir.m.sn,type="response")

plot((z.ir*sd.ir)+mean.ir,data.ptime$X.playim*100, pch = 16,
     col="white",xlab = "immature to adult ratio",ylab="%adult-adult play", 
     ylim=c(0,5),xlim=c(0,1.5),cex.lab=1.5)
lines((newdata.ir.m.aga$z.ir*sd.ir)+mean.ir, predicted.ir.m.aga*100,
      lwd=2,col=1,lty=1,type="l",pch=1)
lines((newdata.ir.m.liz$z.ir*sd.ir)+mean.ir, predicted.ir.m.liz*100,
      lwd=2,col=2,lty=2,type="l",pch=2)
lines((newdata.ir.m.pla$z.ir*sd.ir)+mean.ir, predicted.ir.m.pla*100,
      lwd=2,col=3,lty=3,type="l",pch=3)
lines((newdata.ir.m.ch$z.ir*sd.ir)+mean.ir, predicted.ir.m.ch*100,
      lwd=2,col=4,lty=4,type="l",pch=4)
lines((newdata.ir.m.cp$z.ir*sd.ir)+mean.ir, predicted.ir.m.cp*100,
      lwd=2,col=5,lty=5,type="l",pch=5)
lines((newdata.ir.m.se$z.ir*sd.ir)+mean.ir, predicted.ir.m.se*100,
      lwd=2,col=6,lty=6,type="l",pch=6)
lines((newdata.ir.m.sn$z.ir*sd.ir)+mean.ir, predicted.ir.m.sn*100,
      lwd=2,col=7,lty=2,type="o",pch=18,cex=0.5)
text(1.25,3.85,labels='\\MA',
     vfont=c("sans serif","bold"),cex=5)

###########FEMALES
# Create a temporary data frame of hypothetical values

newdata.fe.f.aga <- data.frame(z.gr = mean(z.gr),z.fe=seq(-1.71,7, 0.1),
                               z.ir=mean(z.ir),SITE="AGA",SEX="f",z.tr=mean(z.tr),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.fe.f.liz <- data.frame(z.gr = mean(z.gr),z.fe=seq(-1.71,7, 0.1),
                               z.ir=mean(z.ir),SITE="LIZ",SEX="f",z.tr=mean(z.tr),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.fe.f.pla <- data.frame(z.gr = mean(z.gr),z.fe=seq(-1.71,7, 0.1),
                               z.ir=mean(z.ir),SITE="PLA",SEX="f",z.tr=mean(z.tr),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.fe.f.ch <- data.frame(z.gr = mean(z.gr),z.fe=seq(-1.71,7, 0.1),
                              z.ir=mean(z.ir),SITE="CH",SEX="f",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.fe.f.cp <- data.frame(z.gr = mean(z.gr),z.fe=seq(-1.71,7, 0.1),
                              z.ir=mean(z.ir),SITE="CP",SEX="f",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.fe.f.se <- data.frame(z.gr = mean(z.gr),z.fe=seq(-1.71,7, 0.1),
                              z.ir=mean(z.ir),SITE="SE",SEX="f",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.fe.f.sn <- data.frame(z.gr = mean(z.gr),z.fe=seq(-1.71,7, 0.1),
                              z.ir=mean(z.ir),SITE="SN",SEX="f",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))

predicted.fe.f.aga <- predict(mod.avg,newdata=newdata.fe.f.aga,type="response")
predicted.fe.f.liz <- predict(mod.avg,newdata=newdata.fe.f.liz,type="response")
predicted.fe.f.pla <- predict(mod.avg,newdata=newdata.fe.f.pla,type="response")
predicted.fe.f.ch <- predict(mod.avg,newdata=newdata.fe.f.ch,type="response")
predicted.fe.f.cp <- predict(mod.avg,newdata=newdata.fe.f.cp,type="response")
predicted.fe.f.se <- predict(mod.avg,newdata=newdata.fe.f.se,type="response")
predicted.fe.f.sn <- predict(mod.avg,newdata=newdata.fe.f.sn,type="response")

######PLOTS

plot(((z.fe*sd.fe)+mean.fe)*100,data.ptime$X.playim*100, pch = 16,
     col="white",xlab = "%feeding fruit", 
     ylab = "%adult-adult play",ylim=c(0,5),xlim=c(0,40),cex.lab=1.5)
lines(((newdata.fe.f.aga$z.fe*sd.fe)+mean.fe)*100, predicted.fe.f.aga*100,
      lwd=2,col=1,lty=1,type="l",pch=1)
lines(((newdata.fe.f.aga$z.fe*sd.fe)+mean.fe)*100, predicted.fe.f.liz*100,
      lwd=2,col=2,lty=2,type="l",pch=2)
lines(((newdata.fe.f.aga$z.fe*sd.fe)+mean.fe)*100, predicted.fe.f.pla*100,
      lwd=2,col=3,lty=3,type="l",pch=3)
lines(((newdata.fe.f.aga$z.fe*sd.fe)+mean.fe)*100, predicted.fe.f.ch*100,
      lwd=2,col=4,lty=4,type="l",pch=4)
lines(((newdata.fe.f.aga$z.fe*sd.fe)+mean.fe)*100, predicted.fe.f.cp*100,
      lwd=2,col=5,lty=5,type="l",pch=5)
lines(((newdata.fe.f.aga$z.fe*sd.fe)+mean.fe)*100, predicted.fe.f.se*100,
      lwd=2,col=6,lty=6,type="l",pch=6)
lines(((newdata.fe.f.aga$z.fe*sd.fe)+mean.fe)*100, predicted.fe.f.sn*100,
      lwd=2,col=7,lty=2,type="o",pch=18,cex=0.5)
text(30,3.85,labels='\\VE',
     vfont=c("sans serif","bold"),cex=5)

#######NOW MALES FEEDING

newdata.fe.m.aga <- data.frame(z.gr = mean(z.gr),z.fe=seq(-1.71,7, 0.1),
                               z.ir=mean(z.ir),SITE="AGA",SEX="m",z.tr=mean(z.tr),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.fe.m.liz <- data.frame(z.gr = mean(z.gr),z.fe=seq(-1.71,7, 0.1),
                               z.ir=mean(z.ir),SITE="LIZ",SEX="m",z.tr=mean(z.tr),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.fe.m.pla <- data.frame(z.gr = mean(z.gr),z.fe=seq(-1.71,7, 0.1),
                               z.ir=mean(z.ir),SITE="PLA",SEX="m",z.tr=mean(z.tr),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.fe.m.ch <- data.frame(z.gr = mean(z.gr),z.fe=seq(-1.71,7, 0.1),
                              z.ir=mean(z.ir),SITE="CH",SEX="m",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.fe.m.cp <- data.frame(z.gr = mean(z.gr),z.fe=seq(-1.71,7, 0.1),
                              z.ir=mean(z.ir),SITE="CP",SEX="m",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.fe.m.se <- data.frame(z.gr = mean(z.gr),z.fe=seq(-1.71,7, 0.1),
                              z.ir=mean(z.ir),SITE="SE",SEX="m",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.fe.m.sn <- data.frame(z.gr = mean(z.gr),z.fe=seq(-1.71,7, 0.1),
                              z.ir=mean(z.ir),SITE="SN",SEX="m",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))

predicted.fe.m.aga <- predict(mod.avg,newdata=newdata.fe.m.aga,type="response")
predicted.fe.m.liz <- predict(mod.avg,newdata=newdata.fe.m.liz,type="response")
predicted.fe.m.pla <- predict(mod.avg,newdata=newdata.fe.m.pla,type="response")
predicted.fe.m.ch <- predict(mod.avg,newdata=newdata.fe.m.ch,type="response")
predicted.fe.m.cp <- predict(mod.avg,newdata=newdata.fe.m.cp,type="response")
predicted.fe.m.se <- predict(mod.avg,newdata=newdata.fe.m.se,type="response")
predicted.fe.m.sn <- predict(mod.avg,newdata=newdata.fe.m.sn,type="response")

######PLOTS
plot(((z.fe*sd.fe)+mean.fe)*100,data.ptime$X.playim*100, pch = 16,
     col="white",xlab = "%feeding fruit", 
     ylab = "%adult-adult play",ylim=c(0,5),xlim=c(0,40),cex.lab=1.5)
lines(((newdata.fe.m.aga$z.fe*sd.fe)+mean.fe)*100, predicted.fe.m.aga*100,
      lwd=2,col=1,lty=1,type="l",pch=1)
lines(((newdata.fe.m.aga$z.fe*sd.fe)+mean.fe)*100, predicted.fe.m.liz*100,
      lwd=2,col=2,lty=2,type="l",pch=2)
lines(((newdata.fe.m.aga$z.fe*sd.fe)+mean.fe)*100, predicted.fe.m.pla*100,
      lwd=2,col=3,lty=3,type="l",pch=3)
lines(((newdata.fe.m.aga$z.fe*sd.fe)+mean.fe)*100, predicted.fe.m.ch*100,
      lwd=2,col=4,lty=4,type="l",pch=4)
lines(((newdata.fe.m.aga$z.fe*sd.fe)+mean.fe)*100, predicted.fe.m.cp*100,
      lwd=2,col=5,lty=5,type="l",pch=5)
lines(((newdata.fe.m.aga$z.fe*sd.fe)+mean.fe)*100, predicted.fe.m.se*100,
      lwd=2,col=6,lty=6,type="l",pch=6)
lines(((newdata.fe.m.aga$z.fe*sd.fe)+mean.fe)*100, predicted.fe.m.sn*100,
      lwd=2,col=7,lty=2,type="o",pch=18,cex=0.5)
text(30,3.85,labels='\\MA',
     vfont=c("sans serif","bold"),cex=5)
```

## Adult-immature social play modelling

```{r}
#clean memory and set directory
#as some names are the same as for adult adult play, to save repeating code
rm(list=ls())
data.ptime<-read.csv("playdatabytype.csv",
                     header=T)
cb.pt<-cbind(data.ptime$ad_im_play,data.ptime$non_ad_im_play)
hist(cb.pt)
plot(cb.pt)
```

```{r}
#standarize parameters
#DENS
mean.dens<-mean(data.ptime$DENS)
sd.dens<-sd(data.ptime$DENS)
z.dens<-(data.ptime$DENS-mean.dens)/sd.dens

#GR, group size
mean.gr<-mean(data.ptime$GR)
sd.gr<-sd(data.ptime$GR)
z.gr<-(data.ptime$GR-mean.gr)/sd.gr

#FE
mean.fe<-mean(data.ptime$X.FE)
sd.fe<-sd(data.ptime$X.FE)
z.fe<-(data.ptime$X.FE-mean.fe)/sd.fe

#TR
mean.tr<-mean(data.ptime$X.TR)
sd.tr<-sd(data.ptime$X.TR)
z.tr<-(data.ptime$X.TR-mean.tr)/sd.tr

#immature ratio
mean.ir<-mean(data.ptime$IM.RATIO)
sd.ir<-sd(data.ptime$IM.RATIO)
z.ir<-(data.ptime$IM.RATIO-mean.ir)/sd.ir

#area size
log.a<-log10(data.ptime$AREA)
mean.area<-mean(log.a)
sd.area<-sd(log.a)
z.area<-(log.a-mean.area)/sd.area
```

```{r}
######models without significant VIF
null.ad.ad<-glmer(cb.pt~+(1|SITE),family=binomial,data=data.ptime)
mo.adad1<-glmer(cb.pt~z.ir+z.gr+z.fe+z.tr+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad3<-glmer(cb.pt~z.ir+z.gr+z.fe+z.tr+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad8<-glmer(cb.pt~z.ir+z.gr+z.fe+z.tr+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad9<-glmer(cb.pt~z.ir+z.gr+z.fe+z.tr+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad10<-glmer(cb.pt~z.ir+z.gr+z.fe+z.tr+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad11<-glmer(cb.pt~z.ir+z.gr+z.fe+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad13<-glmer(cb.pt~z.ir+z.gr+z.fe+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad14<-glmer(cb.pt~z.ir+z.gr+z.tr+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad16<-glmer(cb.pt~z.ir+z.gr+z.tr+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad18<-glmer(cb.pt~z.ir+z.fe+z.tr+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad20<-glmer(cb.pt~z.ir+z.fe+z.tr+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad23<-glmer(cb.pt~z.gr+z.fe+z.tr+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad25<-glmer(cb.pt~z.gr+z.fe+z.tr+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad29<-glmer(cb.pt~z.ir+z.gr+z.fe+z.tr+(1|SITE),family=binomial,data=data.ptime)
mo.adad30<-glmer(cb.pt~z.ir+z.gr+z.fe+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad31<-glmer(cb.pt~z.ir+z.gr+z.fe+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad32<-glmer(cb.pt~z.ir+z.gr+z.fe+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad33<-glmer(cb.pt~z.ir+z.gr+z.tr+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad34<-glmer(cb.pt~z.ir+z.gr+z.tr+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad35<-glmer(cb.pt~z.ir+z.gr+z.tr+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad36<-glmer(cb.pt~z.ir+z.gr+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad38<-glmer(cb.pt~z.ir+z.gr+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad39<-glmer(cb.pt~z.ir+z.fe+z.tr+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad40<-glmer(cb.pt~z.ir+z.fe+z.tr+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad41<-glmer(cb.pt~z.ir+z.fe+z.tr+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad42<-glmer(cb.pt~z.ir+z.fe+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad44<-glmer(cb.pt~z.ir+z.fe+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad45<-glmer(cb.pt~z.ir+z.tr+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad47<-glmer(cb.pt~z.ir+z.tr+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad49<-glmer(cb.pt~z.gr+z.fe+z.tr+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad50<-glmer(cb.pt~z.gr+z.fe+z.tr+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad51<-glmer(cb.pt~z.gr+z.fe+z.tr+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad52<-glmer(cb.pt~z.gr+z.fe+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad54<-glmer(cb.pt~z.gr+z.fe+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad55<-glmer(cb.pt~z.gr+z.tr+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad57<-glmer(cb.pt~z.gr+z.tr+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad59<-glmer(cb.pt~z.fe+z.tr+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad61<-glmer(cb.pt~z.fe+z.tr+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad64<-glmer(cb.pt~z.ir+z.gr+z.fe+(1|SITE),family=binomial,data=data.ptime)
mo.adad65<-glmer(cb.pt~z.ir+z.gr+z.tr+(1|SITE),family=binomial,data=data.ptime)
mo.adad66<-glmer(cb.pt~z.ir+z.gr+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad67<-glmer(cb.pt~z.ir+z.gr+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad68<-glmer(cb.pt~z.ir+z.gr+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad69<-glmer(cb.pt~z.ir+z.fe+z.tr+(1|SITE),family=binomial,data=data.ptime)
mo.adad70<-glmer(cb.pt~z.ir+z.fe+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad71<-glmer(cb.pt~z.ir+z.fe+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad72<-glmer(cb.pt~z.ir+z.fe+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad73<-glmer(cb.pt~z.ir+z.tr+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad74<-glmer(cb.pt~z.ir+z.tr+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad75<-glmer(cb.pt~z.ir+z.tr+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad76<-glmer(cb.pt~z.ir+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad78<-glmer(cb.pt~z.ir+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad79<-glmer(cb.pt~z.gr+z.fe+z.tr+(1|SITE),family=binomial,data=data.ptime)
mo.adad80<-glmer(cb.pt~z.gr+z.fe+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad81<-glmer(cb.pt~z.gr+z.fe+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad82<-glmer(cb.pt~z.gr+z.fe+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad83<-glmer(cb.pt~z.gr+z.tr+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad84<-glmer(cb.pt~z.gr+z.tr+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad85<-glmer(cb.pt~z.gr+z.tr+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad86<-glmer(cb.pt~z.gr+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad88<-glmer(cb.pt~z.gr+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad89<-glmer(cb.pt~z.fe+z.tr+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad90<-glmer(cb.pt~z.fe+z.tr+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad91<-glmer(cb.pt~z.fe+z.tr+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad92<-glmer(cb.pt~z.fe+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad93<-glmer(cb.pt~z.fe+z.dens+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad94<-glmer(cb.pt~z.fe+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad95<-glmer(cb.pt~z.tr+z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad97<-glmer(cb.pt~z.tr+SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad99<-glmer(cb.pt~z.ir+z.gr+(1|SITE),family=binomial,data=data.ptime)
mo.adad100<-glmer(cb.pt~z.ir+z.fe+(1|SITE),family=binomial,data=data.ptime)
mo.adad101<-glmer(cb.pt~z.ir+z.tr+(1|SITE),family=binomial,data=data.ptime)
mo.adad102<-glmer(cb.pt~z.ir+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad103<-glmer(cb.pt~z.ir+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad104<-glmer(cb.pt~z.ir+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad105<-glmer(cb.pt~z.gr+z.fe+(1|SITE),family=binomial,data=data.ptime)
mo.adad106<-glmer(cb.pt~z.gr+z.tr+(1|SITE),family=binomial,data=data.ptime)
mo.adad107<-glmer(cb.pt~z.gr+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad108<-glmer(cb.pt~z.gr+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad109<-glmer(cb.pt~z.gr+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad110<-glmer(cb.pt~z.fe+z.tr+(1|SITE),family=binomial,data=data.ptime)
mo.adad111<-glmer(cb.pt~z.fe+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad112<-glmer(cb.pt~z.fe+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad113<-glmer(cb.pt~z.fe+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad114<-glmer(cb.pt~z.tr+z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad115<-glmer(cb.pt~z.tr+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad116<-glmer(cb.pt~z.tr+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad117<-glmer(cb.pt~z.dens+SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad119<-glmer(cb.pt~SEX+z.area+(1|SITE),family=binomial,data=data.ptime)
mo.adad120<-glmer(cb.pt~z.ir+(1|SITE),family=binomial,data=data.ptime)
mo.adad121<-glmer(cb.pt~z.gr+(1|SITE),family=binomial,data=data.ptime)
mo.adad122<-glmer(cb.pt~z.fe+(1|SITE),family=binomial,data=data.ptime)
mo.adad123<-glmer(cb.pt~z.tr+(1|SITE),family=binomial,data=data.ptime)
mo.adad124<-glmer(cb.pt~z.dens+(1|SITE),family=binomial,data=data.ptime)
mo.adad125<-glmer(cb.pt~SEX+(1|SITE),family=binomial,data=data.ptime)
mo.adad126<-glmer(cb.pt~z.area+(1|SITE),family=binomial,data=data.ptime)
```

```{r}
Cand.mod.all<-list(null.ad.ad,
                   mo.adad1,
                   mo.adad3,
                   mo.adad8,
                   mo.adad9,
                   mo.adad10,
                   mo.adad11,
                   mo.adad13,
                   mo.adad14,
                   mo.adad16,
                   mo.adad18,
                   mo.adad20,
                   mo.adad23,
                   mo.adad25,
                   mo.adad29,
                   mo.adad30,
                   mo.adad31,
                   mo.adad32,
                   mo.adad33,
                   mo.adad34,
                   mo.adad35,
                   mo.adad36,
                   mo.adad38,
                   mo.adad39,
                   mo.adad40,
                   mo.adad41,
                   mo.adad42,
                   mo.adad44,
                   mo.adad45,
                   mo.adad47,
                   mo.adad49,
                   mo.adad50,
                   mo.adad51,
                   mo.adad52,
                   mo.adad54,
                   mo.adad55,
                   mo.adad57,
                   mo.adad59,
                   mo.adad61,
                   mo.adad64,
                   mo.adad65,
                   mo.adad66,
                   mo.adad67,
                   mo.adad68,
                   mo.adad69,
                   mo.adad70,
                   mo.adad71,
                   mo.adad72,
                   mo.adad73,
                   mo.adad74,
                   mo.adad75,
                   mo.adad76,
                   mo.adad78,
                   mo.adad79,
                   mo.adad80,
                   mo.adad81,
                   mo.adad82,
                   mo.adad83,
                   mo.adad84,
                   mo.adad85,
                   mo.adad86,
                   mo.adad88,
                   mo.adad89,
                   mo.adad90,
                   mo.adad91,
                   mo.adad92,
                   mo.adad93,
                   mo.adad94,
                   mo.adad95,
                   mo.adad97,
                   mo.adad99,
                   mo.adad100,
                   mo.adad101,
                   mo.adad102,
                   mo.adad103,
                   mo.adad104,
                   mo.adad105,
                   mo.adad106,
                   mo.adad107,
                   mo.adad108,
                   mo.adad109,
                   mo.adad110,
                   mo.adad111,
                   mo.adad112,
                   mo.adad113,
                   mo.adad114,
                   mo.adad115,
                   mo.adad116,
                   mo.adad117,
                   mo.adad119,
                   mo.adad120,
                   mo.adad121,
                   mo.adad122,
                   mo.adad123,
                   mo.adad124,
                   mo.adad125,
                   mo.adad126)

Modnames1<-c("null.ad.ad=",
             "mo.adad1=z.ir+z.gr+z.fe+z.tr+z.dens+SEX",
             "mo.adad3=z.ir+z.gr+z.fe+z.tr+SEX+z.area",
             "mo.adad8=z.ir+z.gr+z.fe+z.tr+z.dens",
             "mo.adad9=z.ir+z.gr+z.fe+z.tr+SEX",
             "mo.adad10=z.ir+z.gr+z.fe+z.tr+z.area",
             "mo.adad11=z.ir+z.gr+z.fe+z.dens+SEX",
             "mo.adad13=z.ir+z.gr+z.fe+SEX+z.area",
             "mo.adad14=z.ir+z.gr+z.tr+z.dens+SEX",
             "mo.adad16=z.ir+z.gr+z.tr+SEX+z.area",
             "mo.adad18=z.ir+z.fe+z.tr+z.dens+SEX",
             "mo.adad20=z.ir+z.fe+z.tr+SEX+z.area",
             "mo.adad23=z.gr+z.fe+z.tr+z.dens+SEX",
             "mo.adad25=z.gr+z.fe+z.tr+SEX+z.area",
             "mo.adad29=z.ir+z.gr+z.fe+z.tr",
             "mo.adad30=z.ir+z.gr+z.fe+z.dens",
             "mo.adad31=z.ir+z.gr+z.fe+SEX",
             "mo.adad32=z.ir+z.gr+z.fe+z.area",
             "mo.adad33=z.ir+z.gr+z.tr+z.dens",
             "mo.adad34=z.ir+z.gr+z.tr+SEX",
             "mo.adad35=z.ir+z.gr+z.tr+z.area",
             "mo.adad36=z.ir+z.gr+z.dens+SEX",
             "mo.adad38=z.ir+z.gr+SEX+z.area",
             "mo.adad39=z.ir+z.fe+z.tr+z.dens",
             "mo.adad40=z.ir+z.fe+z.tr+SEX",
             "mo.adad41=z.ir+z.fe+z.tr+z.area",
             "mo.adad42=z.ir+z.fe+z.dens+SEX",
             "mo.adad44=z.ir+z.fe+SEX+z.area",
             "mo.adad45=z.ir+z.tr+z.dens+SEX",
             "mo.adad47=z.ir+z.tr+SEX+z.area",
             "mo.adad49=z.gr+z.fe+z.tr+z.dens",
             "mo.adad50=z.gr+z.fe+z.tr+SEX",
             "mo.adad51=z.gr+z.fe+z.tr+z.area",
             "mo.adad52=z.gr+z.fe+z.dens+SEX",
             "mo.adad54=z.gr+z.fe+SEX+z.area",
             "mo.adad55=z.gr+z.tr+z.dens+SEX",
             "mo.adad57=z.gr+z.tr+SEX+z.area",
             "mo.adad59=z.fe+z.tr+z.dens+SEX",
             "mo.adad61=z.fe+z.tr+SEX+z.area",
             "mo.adad64=z.ir+z.gr+z.fe",
             "mo.adad65=z.ir+z.gr+z.tr",
             "mo.adad66=z.ir+z.gr+z.dens",
             "mo.adad67=z.ir+z.gr+SEX",
             "mo.adad68=z.ir+z.gr+z.area",
             "mo.adad69=z.ir+z.fe+z.tr",
             "mo.adad70=z.ir+z.fe+z.dens",
             "mo.adad71=z.ir+z.fe+SEX",
             "mo.adad72=z.ir+z.fe+z.area",
             "mo.adad73=z.ir+z.tr+z.dens",
             "mo.adad74=z.ir+z.tr+SEX",
             "mo.adad75=z.ir+z.tr+z.area",
             "mo.adad76=z.ir+z.dens+SEX",
             "mo.adad78=z.ir+SEX+z.area",
             "mo.adad79=z.gr+z.fe+z.tr",
             "mo.adad80=z.gr+z.fe+z.dens",
             "mo.adad81=z.gr+z.fe+SEX",
             "mo.adad82=z.gr+z.fe+z.area",
             "mo.adad83=z.gr+z.tr+z.dens",
             "mo.adad84=z.gr+z.tr+SEX",
             "mo.adad85=z.gr+z.tr+z.area",
             "mo.adad86=z.gr+z.dens+SEX",
             "mo.adad88=z.gr+SEX+z.area",
             "mo.adad89=z.fe+z.tr+z.dens",
             "mo.adad90=z.fe+z.tr+SEX",
             "mo.adad91=z.fe+z.tr+z.area",
             "mo.adad92=z.fe+z.dens+SEX",
             "mo.adad93=z.fe+z.dens+z.area",
             "mo.adad94=z.fe+SEX+z.area",
             "mo.adad95=z.tr+z.dens+SEX",
             "mo.adad97=z.tr+SEX+z.area",
             "mo.adad99=z.ir+z.gr",
             "mo.adad100=z.ir+z.fe",
             "mo.adad101=z.ir+z.tr",
             "mo.adad102=z.ir+z.dens",
             "mo.adad103=z.ir+SEX",
             "mo.adad104=z.ir+z.area",
             "mo.adad105=z.gr+z.fe",
             "mo.adad106=z.gr+z.tr",
             "mo.adad107=z.gr+z.dens",
             "mo.adad108=z.gr+SEX",
             "mo.adad109=z.gr+z.area",
             "mo.adad110=z.fe+z.tr",
             "mo.adad111=z.fe+z.dens",
             "mo.adad112=z.fe+SEX",
             "mo.adad113=z.fe+z.area",
             "mo.adad114=z.tr+z.dens",
             "mo.adad115=z.tr+SEX",
             "mo.adad116=z.tr+z.area",
             "mo.adad117=z.dens+SEX",
             "mo.adad119=SEX+z.area",
             "mo.adad120=z.ir",
             "mo.adad121=z.gr",
             "mo.adad122=z.fe",
             "mo.adad123=z.tr",
             "mo.adad124=z.dens",
             "mo.adad125=SEX",
             "mo.adad126=z.area")
#call AICc table 
aictab(Cand.mod.all,modnames=Modnames1)
#95% method to select models!
confset(cand.set = Cand.mod.all, modnames = Modnames1, second.ord = TRUE,
        method = "raw") 
#95% confidence set:
#                                        K     AICc Delta_AICc AICcWt
#mo.adad9=z.ir+z.gr+z.fe+z.tr+SEX        7 76377.97       0.00   0.62
#mo.adad3=z.ir+z.gr+z.fe+z.tr+SEX+z.area 8 76380.13       2.16   0.21
#mo.adad1=z.ir+z.gr+z.fe+z.tr+z.dens+SEX 8 76380.57       2.60   0.17
```

```{r}
plot(mo.adad9)
plot(mo.adad3)
plot(mo.adad1)
```

```{r}
#average 3 best models explaining adult immature social play
Cand.mod.best<-list(mo.adad9,mo.adad3,mo.adad1)
mod.avg<-model.avg(Cand.mod.best)
summary(mod.avg)
```

```{r}
par(mfrow=c(3,2))
par(mar = c(4, 4.5, 0.5, 0.5)) # Set the margin on all sides to 2
data.ptime$X.playim<-data.ptime$ad_im_play/data.ptime$OBSSEC
#prepare predictor dataframes
newdata.gr.f.aga <- data.frame(z.gr = seq(-2.1,3.47,0.1),z.fe=mean(z.fe),
                                z.ir=mean(z.ir),SITE="AGA",SEX="f",z.tr=mean(z.tr),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.gr.f.liz <- data.frame(z.gr = seq(-2.1,3.47,0.1),z.fe=mean(z.fe),
                                  z.ir=mean(z.ir),SITE="LIZ",SEX="f",z.tr=mean(z.tr),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.gr.f.pla <- data.frame(z.gr = seq(-2.1,3.47,0.1),z.fe=mean(z.fe),
                                  z.ir=mean(z.ir),SITE="PLA",SEX="f",z.tr=mean(z.tr),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.gr.f.ch <- data.frame(z.gr = seq(-2.1,3.47,0.1),z.fe=mean(z.fe),
                               z.ir=mean(z.ir),SITE="CH",SEX="f",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.gr.f.cp <- data.frame(z.gr = seq(-2.1,3.47,0.1),z.fe=mean(z.fe),
                               z.ir=mean(z.ir),SITE="CP",SEX="f",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.gr.f.se <- data.frame(z.gr = seq(-2.1,3.47,0.1),z.fe=mean(z.fe),
                               z.ir=mean(z.ir),SITE="SE",SEX="f",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.gr.f.sn <- data.frame(z.gr = seq(-2.1,3.47,0.1),z.fe=mean(z.fe),
                               z.ir=mean(z.ir),SITE="SN",SEX="f",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))

predicted.gr.f.aga <- predict(mod.avg,newdata=newdata.gr.f.aga,type="response")
predicted.gr.f.liz <- predict(mod.avg,newdata=newdata.gr.f.liz,type="response")
predicted.gr.f.pla <- predict(mod.avg,newdata=newdata.gr.f.pla,type="response")
predicted.gr.f.ch <- predict(mod.avg,newdata=newdata.gr.f.ch,type="response")
predicted.gr.f.cp <- predict(mod.avg,newdata=newdata.gr.f.cp,type="response")
predicted.gr.f.se <- predict(mod.avg,newdata=newdata.gr.f.se,type="response")
predicted.gr.f.sn <- predict(mod.avg,newdata=newdata.gr.f.sn,type="response")

#group size on females
plot((z.gr*sd.gr)+mean.gr,data.ptime$X.playim*100, pch = 16,
     col="white",xlab = "group size",ylab="%adult-immature play", 
     ylim=c(0,5),xlim=c(0,40),cex.lab=1.5)
lines((newdata.gr.f.aga$z.gr*sd.gr)+mean.gr, predicted.gr.f.aga*100,
      lwd=2,col=1,lty=1,type="l",pch=1)
lines((newdata.gr.f.liz$z.gr*sd.gr)+mean.gr, predicted.gr.f.liz*100,
      lwd=2,col=2,lty=2,type="l",pch=2)
lines((newdata.gr.f.pla$z.gr*sd.gr)+mean.gr, predicted.gr.f.pla*100,
      lwd=2,col=3,lty=3,type="l",pch=3)
lines((newdata.gr.f.ch$z.gr*sd.gr)+mean.gr, predicted.gr.f.ch*100,
      lwd=2,col=4,lty=4,type="l",pch=4)
lines((newdata.gr.f.cp$z.gr*sd.gr)+mean.gr, predicted.gr.f.cp*100,
      lwd=2,col=5,lty=5,type="l",pch=5)
lines((newdata.gr.f.se$z.gr*sd.gr)+mean.gr, predicted.gr.f.se*100,
      lwd=2,col=6,lty=6,type="l",pch=6)
lines((newdata.gr.f.sn$z.gr*sd.gr)+mean.gr, predicted.gr.f.sn*100,
      lwd=2,col=7,lty=2,type="o",pch=18,cex=0.5)

text(35,4,labels='\\VE',
     vfont=c("sans serif","bold"),cex=5)
legend(0.25,5, legend=c("AGA","LIZ","PLA","CH","CP","SE","SN"),
       col=c(1,2,3,4,5,6,7), lty=c(1,2,3,4,5,6,2), cex=0.8,
       box.lty=1,lwd=1)

######GROUP SIZE OMALES
newdata.gr.m.aga <- data.frame(z.gr = seq(-2.1,3.47,0.1),z.fe=mean(z.fe),
                               z.ir=mean(z.ir),SITE="AGA",SEX="m",z.tr=mean(z.tr),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.gr.m.liz <- data.frame(z.gr = seq(-2.1,3.47,0.1),z.fe=mean(z.fe),
                               z.ir=mean(z.ir),SITE="LIZ",SEX="m",z.tr=mean(z.tr),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.gr.m.pla <- data.frame(z.gr = seq(-2.1,3.47,0.1),z.fe=mean(z.fe),
                               z.ir=mean(z.ir),SITE="PLA",SEX="m",z.tr=mean(z.tr),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.gr.m.ch <- data.frame(z.gr = seq(-2.1,3.47,0.1),z.fe=mean(z.fe),
                              z.ir=mean(z.ir),SITE="CH",SEX="m",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.gr.m.cp <- data.frame(z.gr = seq(-2.1,3.47,0.1),z.fe=mean(z.fe),
                              z.ir=mean(z.ir),SITE="CP",SEX="m",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.gr.m.se <- data.frame(z.gr = seq(-2.1,3.47,0.1),z.fe=mean(z.fe),
                              z.ir=mean(z.ir),SITE="SE",SEX="m",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.gr.m.sn <- data.frame(z.gr = seq(-2.1,3.47,0.1),z.fe=mean(z.fe),
                              z.ir=mean(z.ir),SITE="SN",SEX="m",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))

predicted.gr.m.aga <- predict(mod.avg,newdata=newdata.gr.m.aga,type="response")
predicted.gr.m.liz <- predict(mod.avg,newdata=newdata.gr.m.liz,type="response")
predicted.gr.m.pla <- predict(mod.avg,newdata=newdata.gr.m.pla,type="response")
predicted.gr.m.ch <- predict(mod.avg,newdata=newdata.gr.m.ch,type="response")
predicted.gr.m.cp <- predict(mod.avg,newdata=newdata.gr.m.cp,type="response")
predicted.gr.m.se <- predict(mod.avg,newdata=newdata.gr.m.se,type="response")
predicted.gr.m.sn <- predict(mod.avg,newdata=newdata.gr.m.sn,type="response")

#group size females
plot((z.gr*sd.gr)+mean.gr,data.ptime$X.playim*100, pch = 16,
     col="white",xlab = "group size",ylab="%adult-immature play", 
     ylim=c(0,5),xlim=c(0,40),cex.lab=1.5)
lines((newdata.gr.m.aga$z.gr*sd.gr)+mean.gr, predicted.gr.m.aga*100,
      lwd=2,col=1,lty=1,type="l",pch=1)
lines((newdata.gr.m.liz$z.gr*sd.gr)+mean.gr, predicted.gr.m.liz*100,
      lwd=2,col=2,lty=2,type="l",pch=2)
lines((newdata.gr.m.pla$z.gr*sd.gr)+mean.gr, predicted.gr.m.pla*100,
      lwd=2,col=3,lty=3,type="l",pch=3)
lines((newdata.gr.m.ch$z.gr*sd.gr)+mean.gr, predicted.gr.m.ch*100,
      lwd=2,col=4,lty=4,type="l",pch=4)
lines((newdata.gr.m.cp$z.gr*sd.gr)+mean.gr, predicted.gr.m.cp*100,
      lwd=2,col=5,lty=5,type="l",pch=5)
lines((newdata.gr.m.se$z.gr*sd.gr)+mean.gr, predicted.gr.m.se*100,
      lwd=2,col=6,lty=6,type="l",pch=6)
lines((newdata.gr.m.sn$z.gr*sd.gr)+mean.gr, predicted.gr.m.sn*100,
      lwd=2,col=7,lty=2,type="o",pch=18,cex=0.5)
text(35,3.85,labels='\\MA',
     vfont=c("sans serif","bold"),cex=5)

#IR immature to adult ratio
#(0-mean.ir)/sd.ir
#(1.5-mean.ir)/sd.ir

#FEMALES
newdata.ir.f.aga <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                               z.ir=seq(-2.08,7.4,0.1),SITE="AGA",SEX="f",z.tr=mean(z.tr),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.ir.f.liz <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                               z.ir=seq(-2.08,7.4,0.1),SITE="LIZ",SEX="f",z.tr=mean(z.tr),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.ir.f.pla <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                               z.ir=seq(-2.08,7.4,0.1),SITE="PLA",SEX="f",z.tr=mean(z.tr),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.ir.f.ch <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                              z.ir=seq(-2.08,7.4,0.1),SITE="CH",SEX="f",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.ir.f.cp <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                              z.ir=seq(-2.08,7.4,0.1),SITE="CP",SEX="f",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.ir.f.se <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                              z.ir=seq(-2.08,7.4,0.1),SITE="SE",SEX="f",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.ir.f.sn <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                              z.ir=seq(-2.08,7.4,0.1),SITE="SN",SEX="f",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))

predicted.ir.f.aga <- predict(mod.avg,newdata=newdata.ir.f.aga,type="response")
predicted.ir.f.liz <- predict(mod.avg,newdata=newdata.ir.f.liz,type="response")
predicted.ir.f.pla <- predict(mod.avg,newdata=newdata.ir.f.pla,type="response")
predicted.ir.f.ch <- predict(mod.avg,newdata=newdata.ir.f.ch,type="response")
predicted.ir.f.cp <- predict(mod.avg,newdata=newdata.ir.f.cp,type="response")
predicted.ir.f.se <- predict(mod.avg,newdata=newdata.ir.f.se,type="response")
predicted.ir.f.sn <- predict(mod.avg,newdata=newdata.ir.f.sn,type="response")

plot((z.ir*sd.ir)+mean.ir,data.ptime$X.playim*100, pch = 16,
     col="white",xlab = "immature to adult ratio",ylab="%adult-immature play", 
     ylim=c(0,5),xlim=c(0,1.5),cex.lab=1.5)
lines((newdata.ir.f.aga$z.ir*sd.ir)+mean.ir, predicted.ir.f.aga*100,
      lwd=2,col=1,lty=1,type="l",pch=1)
lines((newdata.ir.f.liz$z.ir*sd.ir)+mean.ir, predicted.ir.f.liz*100,
      lwd=2,col=2,lty=2,type="l",pch=2)
lines((newdata.ir.f.pla$z.ir*sd.ir)+mean.ir, predicted.ir.f.pla*100,
      lwd=2,col=3,lty=3,type="l",pch=3)
lines((newdata.ir.f.ch$z.ir*sd.ir)+mean.ir, predicted.ir.f.ch*100,
      lwd=2,col=4,lty=4,type="l",pch=4)
lines((newdata.ir.f.cp$z.ir*sd.ir)+mean.ir, predicted.ir.f.cp*100,
      lwd=2,col=5,lty=5,type="l",pch=5)
lines((newdata.ir.f.se$z.ir*sd.ir)+mean.ir, predicted.ir.f.se*100,
      lwd=2,col=6,lty=6,type="l",pch=6)
lines((newdata.ir.f.sn$z.ir*sd.ir)+mean.ir, predicted.ir.f.sn*100,
      lwd=2,col=7,lty=2,type="o",pch=18,cex=0.5)

text(1.25,3.85,labels='\\VE',
     vfont=c("sans serif","bold"),cex=5)

######IR ON MALES
######
######

# Create a temporary data frame of hypothetical values
newdata.ir.m.aga <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                               z.ir=seq(-2.08,7.4,0.1),SITE="AGA",SEX="m",z.tr=mean(z.tr),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.ir.m.liz <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                               z.ir=seq(-2.08,7.4,0.1),SITE="LIZ",SEX="m",z.tr=mean(z.tr),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.ir.m.pla <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                               z.ir=seq(-2.08,7.4,0.1),SITE="PLA",SEX="m",z.tr=mean(z.tr),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.ir.m.ch <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                              z.ir=seq(-2.08,7.4,0.1),SITE="CH",SEX="m",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.ir.m.cp <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                              z.ir=seq(-2.08,7.4,0.1),SITE="CP",SEX="m",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.ir.m.se <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                              z.ir=seq(-2.08,7.4,0.1),SITE="SE",SEX="m",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.ir.m.sn <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                              z.ir=seq(-2.08,7.4,0.1),SITE="SN",SEX="m",z.tr=mean(z.tr),
                              z.dens=mean(z.dens),z.area=mean(z.area))

predicted.ir.m.aga <- predict(mod.avg,newdata=newdata.ir.m.aga,type="response")
predicted.ir.m.liz <- predict(mod.avg,newdata=newdata.ir.m.liz,type="response")
predicted.ir.m.pla <- predict(mod.avg,newdata=newdata.ir.m.pla,type="response")
predicted.ir.m.ch <- predict(mod.avg,newdata=newdata.ir.m.ch,type="response")
predicted.ir.m.cp <- predict(mod.avg,newdata=newdata.ir.m.cp,type="response")
predicted.ir.m.se <- predict(mod.avg,newdata=newdata.ir.m.se,type="response")
predicted.ir.m.sn <- predict(mod.avg,newdata=newdata.ir.m.sn,type="response")

######
plot((z.ir*sd.ir)+mean.ir,data.ptime$X.playim*100, pch = 16,
     col="white",xlab = "immature to adult ratio",ylab="%adult-immature play", 
     ylim=c(0,5),xlim=c(0,1.5),cex.lab=1.5)
lines((newdata.ir.m.aga$z.ir*sd.ir)+mean.ir, predicted.ir.m.aga*100,
      lwd=2,col=1,lty=1,type="l",pch=1)
lines((newdata.ir.m.liz$z.ir*sd.ir)+mean.ir, predicted.ir.m.liz*100,
      lwd=2,col=2,lty=2,type="l",pch=2)
lines((newdata.ir.m.pla$z.ir*sd.ir)+mean.ir, predicted.ir.m.pla*100,
      lwd=2,col=3,lty=3,type="l",pch=3)
lines((newdata.ir.m.ch$z.ir*sd.ir)+mean.ir, predicted.ir.m.ch*100,
      lwd=2,col=4,lty=4,type="l",pch=4)
lines((newdata.ir.m.cp$z.ir*sd.ir)+mean.ir, predicted.ir.m.cp*100,
      lwd=2,col=5,lty=5,type="l",pch=5)
lines((newdata.ir.m.se$z.ir*sd.ir)+mean.ir, predicted.ir.m.se*100,
      lwd=2,col=6,lty=6,type="l",pch=6)
lines((newdata.ir.m.sn$z.ir*sd.ir)+mean.ir, predicted.ir.m.sn*100,
      lwd=2,col=7,lty=2,type="o",pch=18,cex=0.5)
text(1.25,3.85,labels='\\MA',
     vfont=c("sans serif","bold"),cex=5)

#######TRAVELLING
#######
#######
#######

newdata.tr.f.aga <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                               z.ir=mean(z.ir),SITE="AGA",SEX="f",z.tr=seq(-1.71,7, 0.1),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.tr.f.liz <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                               z.ir=mean(z.ir),SITE="LIZ",SEX="f",z.tr=seq(-1.71,7, 0.1),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.tr.f.pla <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                               z.ir=mean(z.ir),SITE="PLA",SEX="f",z.tr=seq(-1.71,7, 0.1),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.tr.f.ch <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                              z.ir=mean(z.ir),SITE="CH",SEX="f",z.tr=seq(-1.71,7, 0.1),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.tr.f.cp <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                              z.ir=mean(z.ir),SITE="CP",SEX="f",z.tr=seq(-1.71,7, 0.1),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.tr.f.se <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                              z.ir=mean(z.ir),SITE="SE",SEX="f",z.tr=seq(-1.71,7, 0.1),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.tr.f.sn <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                              z.ir=mean(z.ir),SITE="SN",SEX="f",z.tr=seq(-1.71,7, 0.1),
                              z.dens=mean(z.dens),z.area=mean(z.area))


predicted.tr.f.aga <- predict(mod.avg,newdata=newdata.tr.f.aga,type="response")
predicted.tr.f.liz <- predict(mod.avg,newdata=newdata.tr.f.liz,type="response")
predicted.tr.f.pla <- predict(mod.avg,newdata=newdata.tr.f.pla,type="response")
predicted.tr.f.ch <- predict(mod.avg,newdata=newdata.tr.f.ch,type="response")
predicted.tr.f.cp <- predict(mod.avg,newdata=newdata.tr.f.cp,type="response")
predicted.tr.f.se <- predict(mod.avg,newdata=newdata.tr.f.se,type="response")
predicted.tr.f.sn <- predict(mod.avg,newdata=newdata.tr.f.sn,type="response")

######PLOTS

plot(((z.tr*sd.tr)+mean.tr)*100,data.ptime$X.playim*100, pch = 16,
     col="white",xlab = "%travelling", 
     ylab = "%adult-immature play",ylim=c(0,5),xlim=c(0,40),cex.lab=1.5)
lines(((newdata.tr.f.aga$z.tr*sd.tr)+mean.tr)*100, predicted.tr.f.aga*100,
      lwd=2,col=1,lty=1,type="l",pch=1)
lines(((newdata.tr.f.aga$z.tr*sd.tr)+mean.tr)*100, predicted.tr.f.liz*100,
      lwd=2,col=2,lty=2,type="l",pch=2)
lines(((newdata.tr.f.aga$z.tr*sd.tr)+mean.tr)*100, predicted.tr.f.pla*100,
      lwd=2,col=3,lty=3,type="l",pch=3)
lines(((newdata.tr.f.aga$z.tr*sd.tr)+mean.tr)*100, predicted.tr.f.ch*100,
      lwd=2,col=4,lty=4,type="l",pch=4)
lines(((newdata.tr.f.aga$z.tr*sd.tr)+mean.tr)*100, predicted.tr.f.cp*100,
      lwd=2,col=5,lty=5,type="l",pch=5)
lines(((newdata.tr.f.aga$z.tr*sd.tr)+mean.tr)*100, predicted.tr.f.se*100,
      lwd=2,col=6,lty=6,type="l",pch=6)
lines(((newdata.tr.f.aga$z.tr*sd.tr)+mean.tr)*100, predicted.tr.f.sn*100,
      lwd=2,col=7,lty=2,type="o",pch=18,cex=0.5)
text(30,3.85,labels='\\VE',
     vfont=c("sans serif","bold"),cex=5)

#######NOW MALES TRAVELLING
#######AND DONE!

newdata.tr.m.aga <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                               z.ir=mean(z.ir),SITE="AGA",SEX="m",z.tr=seq(-1.71,7, 0.1),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.tr.m.liz <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                               z.ir=mean(z.ir),SITE="LIZ",SEX="m",z.tr=seq(-1.71,7, 0.1),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.tr.m.pla <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                               z.ir=mean(z.ir),SITE="PLA",SEX="m",z.tr=seq(-1.71,7, 0.1),
                               z.dens=mean(z.dens),z.area=mean(z.area))
newdata.tr.m.ch <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                              z.ir=mean(z.ir),SITE="CH",SEX="m",z.tr=seq(-1.71,7, 0.1),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.tr.m.cp <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                              z.ir=mean(z.ir),SITE="CP",SEX="m",z.tr=seq(-1.71,7, 0.1),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.tr.m.se <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                              z.ir=mean(z.ir),SITE="SE",SEX="m",z.tr=seq(-1.71,7, 0.1),
                              z.dens=mean(z.dens),z.area=mean(z.area))
newdata.tr.m.sn <- data.frame(z.gr = mean(z.gr),z.fe=mean(z.fe),
                              z.ir=mean(z.ir),SITE="SN",SEX="m",z.tr=seq(-1.71,7, 0.1),
                              z.dens=mean(z.dens),z.area=mean(z.area))

predicted.tr.m.aga <- predict(mod.avg,newdata=newdata.tr.m.aga,type="response")
predicted.tr.m.liz <- predict(mod.avg,newdata=newdata.tr.m.liz,type="response")
predicted.tr.m.pla <- predict(mod.avg,newdata=newdata.tr.m.pla,type="response")
predicted.tr.m.ch <- predict(mod.avg,newdata=newdata.tr.m.ch,type="response")
predicted.tr.m.cp <- predict(mod.avg,newdata=newdata.tr.m.cp,type="response")
predicted.tr.m.se <- predict(mod.avg,newdata=newdata.tr.m.se,type="response")
predicted.tr.m.sn <- predict(mod.avg,newdata=newdata.tr.m.sn,type="response")

######PLOTS
plot(((z.tr*sd.tr)+mean.tr)*100,data.ptime$X.playim*100, pch = 16,
     col="white",xlab = "%travelling", 
     ylab = "%adult-immature play",ylim=c(0,5),xlim=c(0,40),cex.lab=1.5)
lines(((newdata.tr.m.aga$z.tr*sd.tr)+mean.tr)*100, predicted.tr.m.aga*100,
      lwd=2,col=1,lty=1,type="l",pch=1)
lines(((newdata.tr.m.aga$z.tr*sd.tr)+mean.tr)*100, predicted.tr.m.liz*100,
      lwd=2,col=2,lty=2,type="l",pch=2)
lines(((newdata.tr.m.aga$z.tr*sd.tr)+mean.tr)*100, predicted.tr.m.pla*100,
      lwd=2,col=3,lty=3,type="l",pch=3)
lines(((newdata.tr.m.aga$z.tr*sd.tr)+mean.tr)*100, predicted.tr.m.ch*100,
      lwd=2,col=4,lty=4,type="l",pch=4)
lines(((newdata.tr.m.aga$z.tr*sd.tr)+mean.tr)*100, predicted.tr.m.cp*100,
      lwd=2,col=5,lty=5,type="l",pch=5)
lines(((newdata.tr.m.aga$z.tr*sd.tr)+mean.tr)*100, predicted.tr.m.se*100,
      lwd=2,col=6,lty=6,type="l",pch=6)
lines(((newdata.tr.m.aga$z.tr*sd.tr)+mean.tr)*100, predicted.tr.m.sn*100,
      lwd=2,col=7,lty=2,type="o",pch=18,cex=0.5)
text(30,3.85,labels='\\MA',
     vfont=c("sans serif","bold"),cex=5)
```

## Adult social play preferences

```{r}
rm(list=ls())
setwd("~/Documents/R scripts and data/PLAY")
pref.data<-read.csv("playprefCORR.csv",header=TRUE)
dim(pref.data)
head(pref.data)
```

```{r}
boxplot(ADULT.PREF ~ SEX, data = pref.data,
        xlab = "Sex", ylab = "adult play pref. index",
        varwidth = TRUE,
        col = "lightgray",outline=F,
        cex.lab=1.5,medcol="red",ylim=c(-2.25,2.25))
means <- tapply(pref.data$ADULT.PREF,pref.data$SEX,mean)
abline(h=0,lty=3)
text(1.75, 2, "preference for adults",
     cex = 1)
text(1.75, -2, "preference for immatures",
     cex = 1)
points(c(-0.22,-0.043),pch=3,
       cex=1.5)
```

```{r}
t.test(ADULT.PREF~SEX,data=pref.data)
```

```{r}
#subset males and females to test whether pref is dif from 0
pref.data.f<- pref.data[which(pref.data$SEX=='f'),]
pref.data.m<- pref.data[which(pref.data$SEX=='m'),]
t.test(pref.data.f$ADULT.PREF)
t.test(pref.data.m$ADULT.PREF)
#not significant either sex, indeed the CI includes 0!
```